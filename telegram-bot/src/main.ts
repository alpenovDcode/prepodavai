import { Bot } from 'grammy';
import * as dotenv from 'dotenv';

dotenv.config();

const bot = new Bot(process.env.TELEGRAM_BOT_TOKEN || '');

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
bot.command('start', async (ctx) => {
  const user = ctx.from;
  if (!user) return;

  // Ð—Ð´ÐµÑÑŒ Ð±ÑƒÐ´ÐµÑ‚ Ð»Ð¾Ð³Ð¸ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ‡ÐµÑ€ÐµÐ· API
  // ÐŸÐ¾ÐºÐ° Ð·Ð°Ð³Ð»ÑƒÑˆÐºÐ°
  await ctx.reply(
    `Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² prepodavAI ðŸŽ“\n\n` +
    `Ð¯ Ñ‚Ð²Ð¾Ð¹ Ð¸Ð½Ñ‚ÐµÐ»Ð»ÐµÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº Ð´Ð»Ñ:\n` +
    `â€” Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑƒÑ‡ÐµÐ±Ð½Ñ‹Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²\n` +
    `â€” ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑƒÑ€Ð¾ÐºÐ¾Ð²\n` +
    `â€” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ€Ð°Ð±Ð¾Ñ‚ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ¾Ð²\n` +
    `â€” ÐÐ´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°\n` +
    `â€” ÐœÐµÑ‚Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸\n\n` +
    `ÐžÑ‚ÐºÑ€Ð¾Ð¹ Mini App Ð´Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹!`
  );
});

// Ð—Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð°
bot.start();
console.log('ðŸ¤– Telegram bot started');

// Graceful shutdown
process.on('SIGTERM', () => {
  bot.stop();
  process.exit(0);
});

