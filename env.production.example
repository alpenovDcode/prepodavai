# ===========================================
# PrepodavAI - Production Environment Variables
# ===========================================
# КРИТИЧЕСКИ ВАЖНО: Все значения должны быть установлены перед запуском в production!
# ===========================================

# ========== DATABASE (PostgreSQL) ==========
# Обязательно: Используйте сильный пароль (минимум 16 символов)
POSTGRES_USER=prepodavai
POSTGRES_PASSWORD=GuRdgoEizqhmtXu08LzS5wiyeKZmpbZM
POSTGRES_DB=prepodavai
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}?schema=public

# ========== REDIS ==========
# Обязательно: Используйте сильный пароль (минимум 16 символов)
REDIS_PASSWORD=ILMvpCBW0sAydnebhmCNnofqZVBywpjV
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# ========== JWT AUTHENTICATION ==========
# КРИТИЧНО: Минимум 32 символа! Используйте cryptographically secure random string
# Генерация: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=1e3521e69086de5ddebda365d53fea820474f692d3adaffe2c86552ab0d0e3cd
JWT_EXPIRES_IN=7d

# ========== ADMIN ACCESS ==========
# Обязательно: UUID пользователей-администраторов через запятую
# Получить ID пользователя можно из базы данных (таблица app_users)
ADMIN_USER_IDS=uuid1,uuid2,uuid3

# ========== WEBHOOK SECURITY ==========
# Обязательно для production: Защита webhook endpoints от n8n
# Вариант 1: Использовать секрет (рекомендуется)
WEBHOOK_SECRET=0b925ba01decbb62128fa6f2589225479e7b54c360cbf3db77db6b424d79d6b6

# Вариант 2: IP whitelist (опционально, вместо или вместе с WEBHOOK_SECRET)
# WEBHOOK_ALLOWED_IPS=1.2.3.4,5.6.7.8

# ========== TELEGRAM ==========
# Обязательно: Токен бота от @BotFather
TELEGRAM_BOT_TOKEN=YOUR_TELEGRAM_BOT_TOKEN_FROM_BOTFATHER
NEXT_PUBLIC_TELEGRAM_BOT_NAME=your_bot_username

# ========== API KEYS ==========
# OpenAI API ключ (опционально, если используете напрямую)
OPENAI_API_KEY=sk-your-openai-api-key-here

# Gamma AI API ключ (опционально, для генерации презентаций)
GAMMA_API_KEY=your-gamma-api-key-here

# ========== N8N WEBHOOKS ==========
# Обязательно: URL вашего n8n инстанса для генераций
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook

# ========== SERVER CONFIGURATION ==========
NODE_ENV=production
PORT=3001

# CORS: Обязательно указать конкретные домены (НЕ использовать *)
# Разрешено несколько доменов через запятую
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com

# Base URL для генерации URL файлов (опционально, по умолчанию используется PORT)
BASE_URL=https://api.yourdomain.com

# URL веб-приложения для Telegram бота
WEB_APP_URL=https://yourdomain.com

# ========== FRONTEND ==========
# Обязательно: URL backend API (должен совпадать с BASE_URL или быть доступен по нему)
NEXT_PUBLIC_API_URL=https://api.yourdomain.com

# ========== OPTIONAL ==========
# Директория для загрузки файлов (по умолчанию ./uploads)
# UPLOAD_DIR=/var/uploads/prepodavai

# ===========================================
# ИНСТРУКЦИЯ ПО НАСТРОЙКЕ:
# ===========================================
# 
# 1. Скопируйте этот файл в .env в корне проекта:
#    cp env.production.example .env
#
# 2. Сгенерируйте все секреты:
#    # JWT_SECRET (64 hex символа = 32 байта)
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
#    # REDIS_PASSWORD и WEBHOOK_SECRET
#    node -e "console.log(require('crypto').randomBytes(24).toString('base64'))"
#
# 3. Установите POSTGRES_PASSWORD (минимум 16 символов)
#
# 4. Установите ADMIN_USER_IDS после создания первого админа в БД
#
# 5. Обновите CORS_ORIGIN с вашими доменами
#
# 6. Обновите NEXT_PUBLIC_API_URL и BASE_URL с вашими доменами
#
# 7. Проверьте что NODE_ENV=production
#
# 8. НИКОГДА не коммитьте .env файл в git!
#
# ===========================================

