# –ú–∏–≥—Ä–∞—Ü–∏—è —Å Chatium –Ω–∞ –Ω–æ–≤—ã–π —Å—Ç–µ–∫

## –û–±–∑–æ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

–ü—Ä–æ–µ–∫—Ç –º–∏–≥—Ä–∏—Ä—É–µ—Ç —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Chatium –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫:
- **Frontend**: Next.js 14+ (App Router) + React 18+ + TypeScript
- **Backend**: NestJS + PostgreSQL + Prisma
- **–û—á–µ—Ä–µ–¥–∏**: BullMQ + Redis
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**: Telegram Bot API, OpenAI, Gamma AI, n8n Webhooks

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ë—ã–ª–æ (Chatium):**
- –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ Chatium
- Heap —Ç–∞–±–ª–∏—Ü—ã (–ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–∞—è –ë–î)
- Chatium Jobs –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–°—Ç–∞–ª–æ:**
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (frontend/backend/worker)
- PostgreSQL + Prisma ORM
- BullMQ –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Webhooks

**–í–∞–∂–Ω–æ:** –í—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ n8n webhooks (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

- –ó–∞–ø—Ä–æ—Å ‚Üí Backend ‚Üí n8n Webhook (async)
- n8n –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí Callback –≤ Backend
- Backend –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å ‚Üí Queue –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã:**
- `app_users` ‚Üí `AppUser` (Prisma)
- `user_generations` ‚Üí `UserGeneration` (Prisma)
- `generation_requests` ‚Üí `GenerationRequest` (Prisma)
- `user_subscriptions` ‚Üí `UserSubscription` (Prisma)
- `subscription_plans` ‚Üí `SubscriptionPlan` (Prisma)
- `credit_costs` ‚Üí `CreditCost` (Prisma)
- `credit_transactions` ‚Üí `CreditTransaction` (Prisma)
- `system_logs` ‚Üí `SystemLog` (Prisma)

### 4. API Endpoints

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ API:**
```
/api/generate/:type          - –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
/api/generate/:requestId     - –°—Ç–∞—Ç—É—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
/api/generate/history/list   - –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
/api/webhooks/:type-callback - Callback –æ—Ç n8n
/api/subscription/info       - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–µ
/api/subscription/plans      - –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã
/api/subscription/costs      - –°—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
/api/auth/*                  - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
/api/users/*                 - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```

## –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ)
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prisma —Å—Ö–µ–º
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Compose
- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ NestJS

### –≠—Ç–∞–ø 2: Backend Core (üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ)
- [x] –ú–æ–¥—É–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
- [x] –ú–æ–¥—É–ª—å –ø–æ–¥–ø–∏—Å–æ–∫
- [ ] –ú–æ–¥—É–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] –ú–æ–¥—É–ª—å Telegram
- [ ] –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –ú–æ–¥—É–ª—å –ª–æ–≥–æ–≤

### –≠—Ç–∞–ø 3: Frontend (‚è≥ –û–∂–∏–¥–∞–µ—Ç)
- [ ] Next.js —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API
- [ ] Telegram WebApp
- [ ] –ú–æ–¥—É–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 4: Worker (‚è≥ –û–∂–∏–¥–∞–µ—Ç)
- [ ] BullMQ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- [ ] Processors –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram

### –≠—Ç–∞–ø 5: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (‚è≥ –û–∂–∏–¥–∞–µ—Ç)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Chatium
- [ ] –ò–º–ø–æ—Ä—Ç –≤ PostgreSQL
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚è≥ –û–∂–∏–¥–∞–µ—Ç)
- [ ] Unit —Ç–µ—Å—Ç—ã
- [ ] E2E —Ç–µ—Å—Ç—ã
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url>
cd PREPODAVAI

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm run install:all

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Ñ–∞–π–ª—ã
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker Compose
docker-compose up -d

# 5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Prisma
cd backend
npm run prisma:migrate

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm run dev
```

### Production –¥–µ–ø–ª–æ–π

```bash
# Build
npm run build

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose
docker-compose -f docker-compose.prod.yml up -d
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ –í—Å–µ —Ç–∏–ø—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ webhooks
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤ –∏ –ø–æ–¥–ø–∏—Å–æ–∫
- ‚úÖ Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚ö†Ô∏è API endpoints –∏–∑–º–µ–Ω–∏–ª–∏—Å—å (–¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å `/api`)
- ‚ö†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
- ‚ö†Ô∏è –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT –≤–º–µ—Å—Ç–æ Chatium auth

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker-compose logs`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `npm run db:migrate`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î: `npm run db:studio`

